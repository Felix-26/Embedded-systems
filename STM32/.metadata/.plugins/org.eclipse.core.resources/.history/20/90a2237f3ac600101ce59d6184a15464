/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2025 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */

#include <stdint.h>
#include <stdio.h>

#if !defined(__SOFT_FP__) && defined(__ARM_FP)
  #warning "FPU is not initialized, but the project is compiling for an FPU. Please initialize the FPU before use."
#endif

void ITM_Init(void)
{
    // Enable TRACE IO (PB3 = SWO)// Unlock ITM immediately, even before TRCENA
	*(volatile uint32_t*)0xE0000FB0 = 0xC5ACCE55;


    *(volatile uint32_t*)0xE0042004 |= (1 << 5);     // DBGMCU_CR |= TRACE_IOEN

    // Enable TRCENA (Tracing)
    *(volatile uint32_t*)0xE000EDFC |= (1 << 24);    // DEMCR |= TRCENA

    // Unlock ITM
    *(volatile uint32_t*)0xE0000FB0 = 0xC5ACCE55;    // ITM_LAR

    // ITM Trace Control Register
    *(volatile uint32_t*)0xE0000E80 = 0x0001000F;    // ITM_TCR

    // Enable ITM stimulus port 0
    *(volatile uint32_t*)0xE0000E00 = 0x00000001;    // ITM_TER

    // TPIU prescaler (HCLK 84 MHz â†’ SWO 2 MHz)
    *(volatile uint32_t*)0xE0040010 = 41;            // TPI_ACPR

    // NRZ (async SWO)
    *(volatile uint32_t*)0xE00400F0 = 2;             // TPI_SPPR

    // Formatter off
    *(volatile uint32_t*)0xE0040304 = 0x100;         // TPI_FFCR
}

int main(void)
{

	printf("christ is lord");
    /* Loop forever */
	for(;;);
}
